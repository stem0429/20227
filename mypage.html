<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>마이페이지</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <div style="display:flex; align-items:center; gap:16px;">
            <img src="images/donghyunlogo.png" alt="로고" style="height:auto; width:auto; max-width:80px; max-height:80px; object-fit:cover; border-radius:18px; background:#f0f0f0; margin-right:16px; vertical-align:middle;">
            <h1 style="margin:0;">마이페이지</h1>
            <a href="index.html" style="margin-left:auto; background:#2980d9; color:#fff; border:none; border-radius:18px; padding:10px 20px; font-size:1rem; font-weight:600; text-decoration:none;">홈으로</a>
        </div>
    </header>
    <main style="max-width:500px; margin:40px auto; background:#fff; border-radius:16px; box-shadow:0 2px 12px rgba(0,0,0,0.06); padding:32px 24px;">
        <h2>내 정보</h2>
    <div id="mypageInfo" style="font-size:1.1rem; margin-top:18px;"></div>
    <h2 style="margin-top:40px;">구매내역</h2>
    <ul id="purchaseHistory" style="margin-top:18px; font-size:1.05rem; color:#333; display:flex; flex-direction:column; gap:18px; padding:0;"></ul>
    </main>
    <script>
        const userId = localStorage.getItem('loginUser');
        const infoDiv = document.getElementById('mypageInfo');
        if(userId) {
            infoDiv.textContent = `아이디: ${userId}`;
        } else {
            infoDiv.textContent = '로그인이 필요합니다.';
        }

        const purchaseList = document.getElementById('purchaseHistory');
        let history = [];
        if(userId) {
            try {
                history = JSON.parse(localStorage.getItem('purchase_' + userId) || '[]');
            } catch(e) { history = []; }
        }
        if(history.length > 0) {
            history.forEach(item => {
                const li = document.createElement('li');
                li.style.display = 'flex';
                li.style.flexDirection = 'column';
                li.style.alignItems = 'flex-start';
                li.style.gap = '8px';
                li.style.listStyle = 'none';
                const dateSpan = document.createElement('span');
                dateSpan.textContent = item.date;
                dateSpan.style.fontSize = '0.98rem';
                dateSpan.style.color = '#888';
                dateSpan.style.marginBottom = '4px';
                li.appendChild(dateSpan);
                const imgRow = document.createElement('div');
                imgRow.style.display = 'flex';
                imgRow.style.flexWrap = 'wrap';
                imgRow.style.gap = '16px';
                item.items.forEach(i => {
                    let imgSrc = '';
                    switch(i.name) {
                        case '뽀뽀 동현': imgSrc = 'images/donghyun1.jpg'; break;
                        case '빡 동현': imgSrc = 'images/donghyun2.jpg'; break;
                        case '콘 동': imgSrc = 'images/donghyun3.jpg'; break;
                        case '호잇 동현': imgSrc = 'images/donghyun4.jpg'; break;
                        case '? 동현': imgSrc = 'images/donghyun5.jpg'; break;
                        case '신 동': imgSrc = 'images/donghyun6.jpg'; break;
                        case '초 동': imgSrc = 'images/donghyun7.jpg'; break;
                        case '그 시절 동현': imgSrc = 'images/donghyun8.jpg'; break;
                        default: imgSrc = '';
                    }
                    if(imgSrc) {
                        const box = document.createElement('div');
                        box.style.display = 'flex';
                        box.style.flexDirection = 'column';
                        box.style.alignItems = 'center';
                        box.style.width = '70px';
                        box.style.marginBottom = '4px';
                        const img = document.createElement('img');
                        img.src = imgSrc;
                        img.alt = i.name;
                        img.style.width = '60px';
                        img.style.height = '60px';
                        img.style.objectFit = 'cover';
                        img.style.borderRadius = '8px';
                        const cnt = document.createElement('span');
                        cnt.textContent = `x${i.count}`;
                        cnt.style.fontWeight = 'bold';
                        cnt.style.marginTop = '4px';
                        box.appendChild(img);
                        box.appendChild(cnt);
                        imgRow.appendChild(box);
                    }
                });
                li.appendChild(imgRow);
                purchaseList.appendChild(li);
            });
        } else {
            const li = document.createElement('li');
            li.textContent = '구매내역이 없습니다.';
            purchaseList.appendChild(li);
        }
    </script>
</body>
</html>

